<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VRPTW Planner</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;600&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-brand">
                <span class="material-icons brand-icon">route</span>
                <h1>VRPTW Planner</h1>
            </div>
            
            <!-- Loading Status -->
            <div id="loading-bar" class="loading-bar" style="display:none;">
                <span class="loading-spinner"></span>
                <span class="loading-text">Processing...</span>
            </div>
            
            <nav class="nav-tabs">
                <button class="nav-tab active" data-tab="benchmark">
                    <span class="material-icons">science</span>
                    Benchmark
                </button>
                <button class="nav-tab" data-tab="production">
                    <span class="material-icons">local_shipping</span>
                    Production
                </button>
                <button class="nav-tab" data-tab="history">
                    <span class="material-icons">history</span>
                    History
                </button>
            </nav>
        </header>

        <div class="main-layout">
            <!-- ===== TAB: BENCHMARK ===== -->
            <div id="tab-benchmark" class="tab-content active">
                <aside class="sidebar">
                    <!-- Solomon Dataset -->
                    <div class="card card-blue">
                        <div class="card-header">
                            <span class="material-icons">folder_open</span>
                            <span>Solomon Dataset</span>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Instance</label>
                                <div class="input-row">
                                    <select id="instance-select" class="form-select">
                                        <option value="">Loading...</option>
                                    </select>
                                    <button id="btn-load" class="btn btn-primary btn-icon" title="Load">
                                        <span class="material-icons">map</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Info -->
                    <div class="card card-green" id="info-card" style="display:none;">
                        <div class="card-header">
                            <span class="material-icons">info</span>
                            <span>Instance Info</span>
                        </div>
                        <div class="card-body">
                            <div class="info-grid">
                                <span>Name</span><span id="info-name">-</span>
                                <span>Customers</span><span id="info-customers">-</span>
                                <span>Capacity</span><span id="info-capacity">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Settings -->
                    <div class="card">
                        <div class="card-header">
                            <span class="material-icons">tune</span>
                            <span>Settings</span>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Max Vehicles</label>
                                <input type="number" id="max-vehicles" class="form-input" value="25" min="1" max="50">
                            </div>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="action-group">
                        <button id="btn-solve" class="btn btn-primary btn-block">
                            <span class="material-icons">play_arrow</span>
                            Run Comparison
                        </button>
                        <button id="btn-clear" class="btn btn-secondary btn-block">
                            <span class="material-icons">refresh</span>
                            Clear
                        </button>
                    </div>

                    <!-- Results -->
                    <div class="card card-purple" id="results-card" style="display:none;">
                        <div class="card-header">
                            <span class="material-icons">analytics</span>
                            <span>Results</span>
                        </div>
                        <div class="card-body" id="results-content"></div>
                    </div>
                </aside>

                <main class="content">
                    <div class="map-grid">
                        <div class="map-panel" id="panel-alns">
                            <div class="map-header">
                                <span class="map-title">ALNS (Baseline)</span>
                                <span class="map-meta" id="meta-alns"></span>
                            </div>
                            <div id="map-alns" class="map-view"></div>
                        </div>
                        <div class="map-panel" id="panel-hybrid">
                            <div class="map-header">
                                <span class="map-title">Hybrid DQN+ALNS</span>
                                <span class="map-meta" id="meta-hybrid"></span>
                            </div>
                            <div id="map-hybrid" class="map-view"></div>
                        </div>
                    </div>
                </main>
            </div>

            <!-- ===== TAB: PRODUCTION ===== -->
            <div id="tab-production" class="tab-content">
                <aside class="sidebar">
                    <!-- Smart Paste -->
                    <div class="card card-blue">
                        <div class="card-header">
                            <span class="material-icons">content_paste</span>
                            <span>Smart Paste</span>
                        </div>
                        <div class="card-body">
                            <div class="paste-hint">
                                Format: <code>Địa chỉ | Khối lượng | Giờ</code>
                            </div>
                            <textarea id="paste-area" class="paste-area">123 Nguyễn Văn Linh, Q7 | 20 | 8-12
456 Nguyễn Thị Thập, Q7 | 15 | 9-17
789 Lê Văn Lương, Q7 | 30 | 10-16
101 Huỳnh Tấn Phát, Q7 | 10 | 8-12
202 Phạm Hữu Lầu, Q7 | 25 | 14-18</textarea>
                            <button id="btn-parse" class="btn btn-secondary btn-block">
                                <span class="material-icons">auto_fix_high</span>
                                Parse Data
                            </button>
                        </div>
                    </div>

                    <!-- Customer List -->
                    <div class="card card-green" id="cust-card" style="display:none;">
                        <div class="card-header">
                            <span class="material-icons">people</span>
                            <span>Customers (<span id="cust-count">0</span>)</span>
                        </div>
                        <div class="card-body card-scroll">
                            <div id="cust-list" class="cust-list"></div>
                        </div>
                    </div>

                    <!-- Fleet Settings -->
                    <div class="card card-orange">
                        <div class="card-header">
                            <span class="material-icons">local_shipping</span>
                            <span>Fleet Settings</span>
                        </div>
                        <div class="card-body">
                            <div class="form-row">
                                <div class="form-group flex-1">
                                    <label class="form-label">Capacity/Vehicle</label>
                                    <input type="number" id="prod-capacity" class="form-input" value="100">
                                </div>
                                <div class="form-group flex-1">
                                    <label class="form-label">Max Vehicles</label>
                                    <input type="number" id="prod-vehicles" class="form-input" value="10">
                                </div>
                            </div>
                            <div class="info-note">
                                <span class="material-icons">info</span>
                                1 Depot với nhiều xe (VRPTW)
                            </div>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="action-group">
                        <button id="btn-add-mode" class="btn btn-secondary btn-block">
                            <span class="material-icons">add_location</span>
                            Click Map to Add
                        </button>
                        <button id="btn-plan" class="btn btn-primary btn-block">
                            <span class="material-icons">route</span>
                            Plan Routes
                        </button>
                    </div>
                </aside>

                <main class="content">
                    <div class="map-panel full">
                        <div class="map-header">
                            <span class="map-title">Route Planning - Quận 7, HCMC</span>
                            <span class="map-meta" id="prod-meta">Click map or paste data</span>
                        </div>
                        <div id="map-prod" class="map-view"></div>
                    </div>
                </main>
            </div>

            <!-- ===== TAB: HISTORY ===== -->
            <div id="tab-history" class="tab-content">
                <div class="history-page">
                    <div class="history-header">
                        <h2>Execution History</h2>
                        <button id="btn-clear-history" class="btn btn-secondary">
                            <span class="material-icons">delete_sweep</span>
                            Clear
                        </button>
                    </div>
                    <div class="history-table-wrap">
                        <table class="data-table" id="history-table">
                            <thead>
                                <tr>
                                    <th>Time</th>
                                    <th>Instance</th>
                                    <th>Winner</th>
                                    <th>Vehicles</th>
                                    <th>Distance</th>
                                </tr>
                            </thead>
                            <tbody id="history-tbody"></tbody>
                        </table>
                        <div id="history-empty" class="empty-state">No history yet</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Status Bar -->
        <footer class="status-bar">
            <span class="material-icons status-icon">info</span>
            <span id="status-text">Ready</span>
        </footer>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="/static/script.js"></script>
</body>
</html>
